<html>
<head>
  <title>Two Dimensional Scatter Plot Example</title>
  <link rel="stylesheet" href="astrojs.css" type="text/css" charset="utf-8">
  <!-- <style>
  canvas {
    border: 1px solid red;
  }
  </style> -->
  <script type="text/javascript" src="lib/gl-matrix.js"></script>
  <script type="text/javascript" src="../dist/ruse.js"></script>
  
  <script type="text/javascript" src="lib/fits.js"></script>
  
  <script type="text/javascript">
  
  function main() {
    
    // Pretend we already have a gl context running
    var canvas = document.querySelector("#ruse");
    canvas.width = 800;
    canvas.height = 400;
    var gl = canvas.getContext("webgl") || canvas.getContext("experimental-webgl");
    
    // Initialize a ruse (aka plot) using an existing gl context
    // var ruse = new astro.Ruse(canvas, 500, 300);
    var ruse = new astro.Ruse(gl);
    
    var key1 = "RACEN";
    var key2 = "DECCEN";
    
    var key3 = "N_GALAXY";
    var key4 = "N_STAR";
    
    new astro.FITS('data/plates-dr9.fits', function(f) {
      var table = f.getDataUnit();
      table.getRows(0, table.rows, function(rows) {
        data1 = rows.map(function(d) {
          datum = {};
          datum[key1] = d[key1];
          datum[key2] = d[key2];
          return datum;
        });
        
        data2 = rows.map(function(d) {
          datum = {};
          datum[key3] = d[key3];
          datum[key4] = d[key4];
          return datum;
        });
        
        ruse.plot(data1);
        
        // setTimeout(function() {
        //   ruse.plot(data2)
        // }, 3000);
        
        // ruse.animate();
        
        document.querySelector('button').onclick = function(e) {
          ruse.plot(data2)
        }
        
        window.ruse = ruse;
      });
    });
    
  }
  </script>
  
</head>

<body onload='main()'>
  <div class='content'>
    <h3>Two Dimension Plot</h3>
    <!-- <div id="ruse"></div> -->
    <button class='change-data'>Change Data</button>
    <div class='container'>
      <canvas id="ruse"></canvas>
    </div>
  </div>
</body>
</html>